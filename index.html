<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ Kalori Pro Premium</title>
    <meta name="theme-color" content="#8B5CF6">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --primary: #8B5CF6; --secondary: #EC4899; --accent: #10B981;
  --bg: #F9FAFB; --text: #1F2937; --text-sec: #6B7280; --border: #E5E7EB;
}
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--bg); color: var(--text); line-height: 1.6; padding-bottom: 90px;
}
.premium-badge {
  display: inline-flex; align-items: center; gap: 6px;
  background: linear-gradient(135deg, #FFD700, #FFA500);
  color: #000; padding: 6px 12px; border-radius: 50px;
  font-size: 11px; font-weight: 700; text-transform: uppercase;
}
.app-header {
  background: linear-gradient(135deg, #8B5CF6, #6366F1);
  padding: 20px; color: white; border-radius: 0 0 30px 30px;
  box-shadow: 0 10px 30px rgba(139,92,246,0.3);
}
.header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
.greeting h1 { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
.profile-pic {
  width: 50px; height: 50px; border-radius: 50%;
  border: 3px solid rgba(255,255,255,0.3); object-fit: cover; cursor: pointer;
}
.daily-summary {
  background: white; margin: -40px 20px 20px; border-radius: 24px;
  padding: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.08);
}
.streak-badge {
  display: inline-flex; align-items: center; gap: 6px;
  background: linear-gradient(135deg, #FEF3C7, #FDE68A);
  color: #92400E; padding: 8px 16px; border-radius: 50px;
  font-size: 13px; font-weight: 600; margin-bottom: 20px;
}
.calorie-ring-wrapper { position: relative; width: 180px; height: 180px; margin: 0 auto 15px; }
.calorie-ring-wrapper svg { transform: rotate(-90deg); }
.calorie-ring-wrapper circle { fill: none; stroke-width: 14; }
.ring-bg { stroke: #F3F4F6; }
.ring-progress { stroke: url(#gradient); stroke-linecap: round; transition: 0.8s; }
.calorie-center {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;
}
.calorie-value {
  font-size: 42px; font-weight: 800;
  background: linear-gradient(135deg, #8B5CF6, #EC4899);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.water-tracker {
  background: linear-gradient(135deg, #DBEAFE, #BFDBFE);
  padding: 20px; border-radius: 16px; margin-bottom: 20px;
}
.water-glasses { display: grid; grid-template-columns: repeat(8, 1fr); gap: 8px; margin: 15px 0; }
.water-glass {
  aspect-ratio: 1; background: white; border-radius: 8px;
  cursor: pointer; transition: 0.3s; font-size: 24px;
  display: flex; align-items: center; justify-content: center;
  border: 2px solid rgba(255,255,255,0.5);
}
.water-glass.filled { background: #3B82F6; border-color: #2563EB; }
.macros-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 25px; }
.macro-card {
  background: var(--bg); padding: 18px 12px; border-radius: 16px; text-align: center;
}
.macro-icon { font-size: 28px; margin-bottom: 8px; }
.macro-value { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
.macro-progress { height: 6px; background: #E5E7EB; border-radius: 10px; overflow: hidden; margin-top: 8px; }
.macro-progress-bar { height: 100%; border-radius: 10px; transition: 0.5s; }
.protein-bar { background: linear-gradient(90deg, #EF4444, #DC2626); }
.carbs-bar { background: linear-gradient(90deg, #F59E0B, #D97706); }
.fat-bar { background: linear-gradient(90deg, #8B5CF6, #7C3AED); }
.container { max-width: 600px; margin: 0 auto; padding: 0 20px 20px; }
.quick-actions { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 25px; }
.action-card {
  background: white; padding: 20px; border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.06); cursor: pointer; transition: 0.3s;
}
.action-card.primary { background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; }
.action-card.blue { background: linear-gradient(135deg, #3B82F6, #2563EB); color: white; }
.action-icon { font-size: 36px; margin-bottom: 12px; }
.card { background: white; border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); }
.meal-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
.meal-option {
  padding: 16px 8px; background: var(--bg); border: 2px solid transparent;
  border-radius: 16px; cursor: pointer; text-align: center; transition: 0.3s;
}
.meal-option.selected {
  background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white;
  box-shadow: 0 4px 15px rgba(139,92,246,0.3);
}
.upload-methods { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
.upload-method {
  border: 3px dashed var(--border); border-radius: 16px; padding: 30px 15px;
  text-align: center; cursor: pointer; transition: 0.3s; background: var(--bg);
}
.upload-method:hover { border-color: var(--primary); background: #F5F3FF; }
#photoInput, #galleryInput, #profilePicInput, #barcodeScanner { display: none; }
.preview-section { display: none; margin-top: 20px; }
.preview-section.show { display: block; }
.preview-image { width: 100%; max-height: 400px; object-fit: cover; border-radius: 20px; margin-bottom: 15px; }
.analyze-btn {
  width: 100%; padding: 18px; background: linear-gradient(135deg, #8B5CF6, #7C3AED);
  color: white; border: none; border-radius: 16px; font-size: 16px; font-weight: 700;
  cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(139,92,246,0.4);
}
.loading { display: none; text-align: center; padding: 40px; }
.loading.show { display: block; }
.spinner {
  width: 60px; height: 60px; margin: 0 auto 20px;
  border: 5px solid #F3F4F6; border-top-color: var(--primary);
  border-radius: 50%; animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.result-section { display: none; margin-top: 20px; }
.result-section.show { display: block; }
.result-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px; }
.result-food-name { font-size: 24px; font-weight: 800; flex: 1; }
.result-score {
  background: linear-gradient(135deg, #FBBF24, #F59E0B); color: white;
  padding: 10px 18px; border-radius: 50px; font-size: 16px; font-weight: 700;
}
.nutrition-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
.nutrition-item { background: var(--bg); padding: 16px; border-radius: 16px; text-align: center; }
.nutrition-item-value { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
.macro-ratios { background: var(--bg); padding: 16px; border-radius: 16px; margin-bottom: 20px; }
.ratio-bars { display: flex; height: 12px; border-radius: 10px; overflow: hidden; margin: 12px 0; }
.ratio-bar { transition: 0.5s; }
.ratio-bar.protein { background: #EF4444; }
.ratio-bar.carbs { background: #F59E0B; }
.ratio-bar.fat { background: #8B5CF6; }
.ai-insight {
  background: linear-gradient(135deg, #DBEAFE, #BFDBFE);
  padding: 18px; border-radius: 16px; margin-bottom: 20px;
}
.save-btn {
  width: 100%; padding: 18px; background: linear-gradient(135deg, #10B981, #059669);
  color: white; border: none; border-radius: 16px; font-size: 16px; font-weight: 700; cursor: pointer;
}
.food-card {
  background: white; border-radius: 16px; padding: 16px; margin-bottom: 10px;
  display: flex; gap: 16px; box-shadow: 0 2px 10px rgba(0,0,0,0.04);
}
.food-image-wrapper {
  width: 80px; height: 80px; flex-shrink: 0; border-radius: 14px; overflow: hidden;
  background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
  display: flex; align-items: center; justify-content: center;
}
.food-image { width: 100%; height: 100%; object-fit: cover; }
.food-placeholder { font-size: 36px; }
.food-details { flex: 1; }
.food-name { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
.food-macros { display: flex; gap: 12px; font-size: 12px; color: var(--text-sec); margin-bottom: 6px; }
.food-score {
  display: inline-flex; align-items: center; gap: 4px;
  background: linear-gradient(135deg, #FEF3C7, #FDE68A);
  color: #92400E; padding: 4px 10px; border-radius: 50px;
  font-size: 12px; font-weight: 700;
}
.food-calories {
  font-size: 22px; font-weight: 800;
  background: linear-gradient(135deg, #8B5CF6, #EC4899);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.delete-btn {
  width: 38px; height: 38px; border-radius: 50%; border: none;
  background: #FEE2E2; color: #DC2626; font-size: 18px; cursor: pointer;
}
.recipe-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.recipe-card {
  background: white; border-radius: 16px; overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.06); cursor: pointer;
}
.recipe-image {
  width: 100%; height: 120px; background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
  display: flex; align-items: center; justify-content: center; font-size: 48px;
}
.recipe-info { padding: 12px; }
.recipe-detail-modal {
  display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5); z-index: 9999; padding: 20px; overflow-y: auto;
}
.recipe-detail-modal.show { display: flex; align-items: center; justify-content: center; }
.recipe-detail-content {
  background: white; border-radius: 24px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto;
}
.bottom-nav {
  position: fixed; bottom: 0; left: 0; right: 0; background: white;
  border-top: 1px solid var(--border); padding: 12px 0;
  display: flex; justify-content: space-around; z-index: 1000;
}
.nav-item {
  flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px;
  padding: 8px; cursor: pointer; color: var(--text-sec); border: none; background: none;
}
.nav-item.active { color: var(--primary); }
.nav-icon { font-size: 26px; }
.nav-label { font-size: 11px; font-weight: 600; }
.settings-card { background: white; border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); }
.profile-pic-large {
  width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--primary);
  object-fit: cover; margin: 0 auto 15px; cursor: pointer; display: block;
}
.input-field {
  width: 100%; padding: 14px 16px; border: 2px solid var(--border);
  border-radius: 12px; font-size: 16px; font-family: inherit; margin-bottom: 16px;
}
.btn-primary {
  width: 100%; padding: 16px; background: linear-gradient(135deg, #8B5CF6, #7C3AED);
  color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer;
}
.btn-danger {
  width: 100%; padding: 16px; background: #FEE2E2; color: #DC2626;
  border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer;
}
.tab-content { display: none; }
.tab-content.active { display: block; }
.empty-state { text-align: center; padding: 60px 20px; }
.empty-icon { font-size: 72px; margin-bottom: 20px; }
    </style>
</head>
<body>
<div class="app-header">
  <div class="header-top">
    <div class="greeting">
      <h1><span id="userName">Merhaba!</span> <span class="premium-badge">ğŸ‘‘ Premium</span></h1>
      <p id="todayDate">BugÃ¼n harika bir gÃ¼n!</p>
    </div>
    <img id="headerProfilePic" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23E5E7EB'/%3E%3Ctext x='50' y='65' font-size='40' text-anchor='middle' fill='%236B7280'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" class="profile-pic" onclick="switchTab('settings')">
  </div>
</div>

<div class="daily-summary">
  <div class="streak-badge">ğŸ”¥ <span id="streakDays">7</span> gÃ¼n Ã¼st Ã¼ste kayÄ±t!</div>
  
  <div class="calorie-ring-wrapper">
    <svg width="180" height="180">
      <defs>
        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#8B5CF6"/>
          <stop offset="100%" style="stop-color:#EC4899"/>
        </linearGradient>
      </defs>
      <circle class="ring-bg" cx="90" cy="90" r="75"></circle>
      <circle id="calorieRing" class="ring-progress" cx="90" cy="90" r="75" stroke-dasharray="471.2" stroke-dashoffset="471.2"></circle>
    </svg>
    <div class="calorie-center">
      <div class="calorie-value" id="totalCal">0</div>
      <div style="font-size:13px;color:#6B7280;font-weight:500">kalori</div>
    </div>
  </div>
  <div style="display:flex;justify-content:center;gap:20px;font-size:14px;color:#6B7280;margin-bottom:25px">
    <div>Kalan: <span style="font-weight:600;color:#8B5CF6" id="remainingCal">2000</span></div>
    <div>Hedef: <span style="font-weight:600;color:#8B5CF6" id="goalCal">2000</span></div>
  </div>

  <div class="water-tracker">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">
      <div style="font-size:16px;font-weight:700;color:#1E40AF">ğŸ’§ Su Takibi</div>
      <div style="font-size:24px;font-weight:800;color:#1E40AF"><span id="waterAmount">0</span>L</div>
    </div>
    <div class="water-glasses" id="waterGlasses"></div>
    <div style="text-align:center;font-size:13px;color:#1E40AF">Hedef: <span id="waterGoal">2.5</span>L (her bardak ~250ml)</div>
  </div>

  <div class="macros-grid">
    <div class="macro-card">
      <div class="macro-icon">ğŸ¥©</div>
      <div class="macro-value" id="totalProtein">0</div>
      <div style="font-size:12px;color:#6B7280;margin-bottom:10px">Protein (g)</div>
      <div style="font-size:11px;color:#8B5CF6;font-weight:600" id="proteinPercent">0%</div>
      <div class="macro-progress">
        <div class="macro-progress-bar protein-bar" id="proteinBar" style="width:0%"></div>
      </div>
    </div>
    <div class="macro-card">
      <div class="macro-icon">ğŸ</div>
      <div class="macro-value" id="totalCarbs">0</div>
      <div style="font-size:12px;color:#6B7280;margin-bottom:10px">Karb. (g)</div>
      <div style="font-size:11px;color:#8B5CF6;font-weight:600" id="carbsPercent">0%</div>
      <div class="macro-progress">
        <div class="macro-progress-bar carbs-bar" id="carbsBar" style="width:0%"></div>
      </div>
    </div>
    <div class="macro-card">
      <div class="macro-icon">ğŸ¥‘</div>
      <div class="macro-value" id="totalFat">0</div>
      <div style="font-size:12px;color:#6B7280;margin-bottom:10px">YaÄŸ (g)</div>
      <div style="font-size:11px;color:#8B5CF6;font-weight:600" id="fatPercent">0%</div>
      <div class="macro-progress">
        <div class="macro-progress-bar fat-bar" id="fatBar" style="width:0%"></div>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div id="homeTab" class="tab-content active">
    <div style="display:flex;justify-content:space-between;align-items:center;margin:25px 0 15px">
      <div style="font-size:20px;font-weight:700">HÄ±zlÄ± Ä°ÅŸlemler</div>
    </div>
    <div class="quick-actions">
      <div class="action-card primary" onclick="switchTab('scan')">
        <div class="action-icon">ğŸ“¸</div>
        <div style="font-size:16px;font-weight:700;margin-bottom:4px">FotoÄŸraf Analizi</div>
        <div style="font-size:13px;opacity:0.8">AI ile analiz et</div>
      </div>
      <div class="action-card" onclick="switchTab('recipes')">
        <div class="action-icon">ğŸ‘¨â€ğŸ³</div>
        <div style="font-size:16px;font-weight:700;margin-bottom:4px">Yemek Tarifleri</div>
        <div style="font-size:13px;opacity:0.8">100+ saÄŸlÄ±klÄ± tarif</div>
      </div>
      <div class="action-card blue" onclick="startBarcodeScanner()">
        <div class="action-icon">ğŸ“Š</div>
        <div style="font-size:16px;font-weight:700;margin-bottom:4px">Barkod Tara</div>
        <div style="font-size:13px;opacity:0.8">HÄ±zlÄ± ekle</div>
      </div>
      <div class="action-card" onclick="switchTab('today')">
        <div class="action-icon">ğŸ“…</div>
        <div style="font-size:16px;font-weight:700;margin-bottom:4px">BugÃ¼nÃ¼n Listesi</div>
        <div style="font-size:13px;opacity:0.8">Ne yedin?</div>
      </div>
    </div>
    <div style="background:linear-gradient(135deg,#FEF3C7,#FDE68A);padding:18px;border-radius:16px;margin-bottom:20px;display:flex;align-items:center;gap:12px">
      <div style="font-size:32px">ğŸ’ª</div>
      <div style="font-size:14px;color:#92400E;font-weight:600;line-height:1.5">
        Harika gidiyorsun! BugÃ¼n <span id="motivationPercent">0</span>% hedefe ulaÅŸtÄ±n.
      </div>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin:25px 0 15px">
      <div style="font-size:20px;font-weight:700">BugÃ¼nkÃ¼ Yemekler</div>
      <div style="color:#8B5CF6;font-size:14px;font-weight:600;cursor:pointer" onclick="switchTab('today')">TÃ¼mÃ¼nÃ¼ GÃ¶r â†’</div>
    </div>
    <div id="todayPreview"></div>
  </div>

  <div id="scanTab" class="tab-content">
    <div class="card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ“¸ Yemek Ekle</h2>
      <div class="meal-selector">
        <button class="meal-option selected" data-meal="breakfast">
          <div style="font-size:24px;margin-bottom:6px">ğŸŒ…</div>
          <div style="font-size:12px;font-weight:600">KahvaltÄ±</div>
        </button>
        <button class="meal-option" data-meal="lunch">
          <div style="font-size:24px;margin-bottom:6px">â˜€ï¸</div>
          <div style="font-size:12px;font-weight:600">Ã–ÄŸle</div>
        </button>
        <button class="meal-option" data-meal="dinner">
          <div style="font-size:24px;margin-bottom:6px">ğŸŒ™</div>
          <div style="font-size:12px;font-weight:600">AkÅŸam</div>
        </button>
        <button class="meal-option" data-meal="snack">
          <div style="font-size:24px;margin-bottom:6px">ğŸª</div>
          <div style="font-size:12px;font-weight:600">AtÄ±ÅŸtÄ±r.</div>
        </button>
      </div>
      <div class="upload-methods">
        <div class="upload-method" onclick="document.getElementById('photoInput').click()">
          <div style="font-size:36px;margin-bottom:10px">ğŸ“·</div>
          <div style="font-size:14px;font-weight:700">FotoÄŸraf Ã‡ek</div>
        </div>
        <div class="upload-method" onclick="document.getElementById('galleryInput').click()">
          <div style="font-size:36px;margin-bottom:10px">ğŸ–¼ï¸</div>
          <div style="font-size:14px;font-weight:700">Galeriden SeÃ§</div>
        </div>
      </div>
      <input type="file" id="photoInput" accept="image/*" capture="environment">
      <input type="file" id="galleryInput" accept="image/*">
      <div id="barcodeScanner">
        <div style="position:relative;width:100%;height:300px;background:#000;border-radius:16px;overflow:hidden">
          <video id="scanner-video" style="width:100%;height:100%;object-fit:cover"></video>
        </div>
        <button class="analyze-btn" style="margin-top:15px" onclick="stopBarcodeScanner()">âŒ TaramayÄ± Durdur</button>
      </div>
      <div class="preview-section" id="previewSection">
        <img id="previewImage" class="preview-image">
        <button class="analyze-btn" id="analyzeBtn">ğŸ¤– AI ile Analiz Et</button>
      </div>
      <div class="loading" id="loadingState">
        <div class="spinner"></div>
        <div style="font-size:16px;color:#6B7280;font-weight:500">AI analiz ediyor...</div>
      </div>
      <div class="result-section" id="resultSection">
        <div class="result-header">
          <div class="result-food-name" id="resultFoodName">-</div>
          <div class="result-score">â­ <span id="resultScore">0</span>/10</div>
        </div>
        <div class="nutrition-grid">
          <div class="nutrition-item">
            <div style="font-size:28px;margin-bottom:8px">ğŸ”¥</div>
            <div class="nutrition-item-value"><span id="resultCalories">0</span></div>
            <div style="font-size:12px;color:#6B7280">Kalori</div>
          </div>
          <div class="nutrition-item">
            <div style="font-size:28px;margin-bottom:8px">ğŸ¥©</div>
            <div class="nutrition-item-value"><span id="resultProtein">0</span>g</div>
            <div style="font-size:12px;color:#6B7280">Protein</div>
          </div>
          <div class="nutrition-item">
            <div style="font-size:28px;margin-bottom:8px">ğŸ</div>
            <div class="nutrition-item-value"><span id="resultCarbs">0</span>g</div>
            <div style="font-size:12px;color:#6B7280">Karbonhidrat</div>
          </div>
          <div class="nutrition-item">
            <div style="font-size:28px;margin-bottom:8px">ğŸ¥‘</div>
            <div class="nutrition-item-value"><span id="resultFat">0</span>g</div>
            <div style="font-size:12px;color:#6B7280">YaÄŸ</div>
          </div>
        </div>
        <div class="macro-ratios">
          <div style="font-size:14px;font-weight:700;color:#6B7280;margin-bottom:12px">Makro Besin OranlarÄ±</div>
          <div class="ratio-bars">
            <div class="ratio-bar protein" id="ratioProtein" style="width:33%"></div>
            <div class="ratio-bar carbs" id="ratioCarbs" style="width:33%"></div>
            <div class="ratio-bar fat" id="ratioFat" style="width:34%"></div>
          </div>
          <div style="display:flex;justify-content:space-around;font-size:12px">
            <div style="display:flex;align-items:center;gap:6px">
              <div style="width:10px;height:10px;border-radius:50%;background:#EF4444"></div>
              <span>Protein <span id="ratioProteinText">0%</span></span>
            </div>
            <div style="display:flex;align-items:center;gap:6px">
              <div style="width:10px;height:10px;border-radius:50%;background:#F59E0B"></div>
              <span>Karb. <span id="ratioCarbsText">0%</span></span>
            </div>
            <div style="display:flex;align-items:center;gap:6px">
              <div style="width:10px;height:10px;border-radius:50%;background:#8B5CF6"></div>
              <span>YaÄŸ <span id="ratioFatText">0%</span></span>
            </div>
          </div>
        </div>
        <div class="ai-insight">
          <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:#1E40AF;margin-bottom:10px;font-size:15px">
            <span>ğŸ’¡</span><span>AI Uzman Yorumu</span>
          </div>
          <div style="color:#1E3A8A;font-size:14px;line-height:1.7" id="resultComment">-</div>
        </div>
        <button class="save-btn" id="saveBtn">âœ… Kaydet ve GÃ¼nlÃ¼ÄŸe Ekle</button>
      </div>
    </div>
  </div>

  <div id="todayTab" class="tab-content">
    <div id="todayMeals"></div>
  </div>

  <div id="recipesTab" class="tab-content">
    <div class="card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ‘¨â€ğŸ³ SaÄŸlÄ±klÄ± Tarifler</h2>
      <div class="recipe-grid" id="recipeGrid"></div>
    </div>
  </div>

  <div id="historyTab" class="tab-content">
    <div class="card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ“Š HaftalÄ±k Ä°lerleme</h2>
      <div style="position:relative;height:250px;margin-top:20px">
        <canvas id="weekChart"></canvas>
      </div>
    </div>
  </div>

  <div id="settingsTab" class="tab-content">
    <div class="settings-card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ‘¤ Profil</h2>
      <div style="text-align:center;margin-bottom:20px">
        <img id="profilePicLarge" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23E5E7EB'/%3E%3Ctext x='50' y='65' font-size='40' text-anchor='middle' fill='%236B7280'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" class="profile-pic-large">
        <button style="background:var(--bg);border:none;padding:10px 20px;border-radius:50px;font-weight:600;cursor:pointer;margin-bottom:15px" onclick="document.getElementById('profilePicInput').click()">ğŸ“¸ FotoÄŸraf DeÄŸiÅŸtir</button>
        <input type="file" id="profilePicInput" accept="image/*">
      </div>
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">Ä°sim</label>
      <input type="text" class="input-field" id="profileName" value="KullanÄ±cÄ±" placeholder="Ä°sminiz">
      <button class="btn-primary" onclick="saveProfile()">ğŸ’¾ Profili Kaydet</button>
    </div>
    <div class="settings-card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ¯ GÃ¼nlÃ¼k Hedeflerim</h2>
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">Kalori Hedefi</label>
      <input type="number" class="input-field" id="goalCalories" value="2000">
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">Protein (gram)</label>
      <input type="number" class="input-field" id="goalProtein" value="150">
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">Karbonhidrat (gram)</label>
      <input type="number" class="input-field" id="goalCarbs" value="200">
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">YaÄŸ (gram)</label>
      <input type="number" class="input-field" id="goalFat" value="60">
      <label style="display:block;font-size:14px;font-weight:600;color:#6B7280;margin-bottom:8px">Su Hedefi (litre)</label>
      <input type="number" class="input-field" id="goalWater" value="2.5" step="0.1">
      <button class="btn-primary" onclick="saveGoals()">ğŸ’¾ Hedefleri Kaydet</button>
    </div>
    <div class="settings-card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">ğŸ“ˆ Ä°statistikler</h2>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px">
        <div style="background:var(--bg);padding:16px;border-radius:16px;text-align:center">
          <div style="font-size:28px;font-weight:800;color:#8B5CF6;margin-bottom:4px" id="totalEntries">0</div>
          <div style="font-size:13px;color:#6B7280">Toplam KayÄ±t</div>
        </div>
        <div style="background:var(--bg);padding:16px;border-radius:16px;text-align:center">
          <div style="font-size:28px;font-weight:800;color:#8B5CF6;margin-bottom:4px" id="avgCalories">0</div>
          <div style="font-size:13px;color:#6B7280">Ort. Kalori</div>
        </div>
      </div>
    </div>
    <div class="settings-card">
      <h2 style="font-size:18px;font-weight:700;margin-bottom:18px">âš ï¸ Tehlikeli BÃ¶lge</h2>
      <button class="btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ TÃ¼m Verileri Sil</button>
    </div>
  </div>
</div>

<div id="recipeModal" class="recipe-detail-modal">
  <div class="recipe-detail-content">
    <div style="position:sticky;top:0;background:white;padding:20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
      <h3 id="recipeModalTitle">Tarif DetayÄ±</h3>
      <button style="width:40px;height:40px;border-radius:50%;border:none;background:var(--bg);font-size:20px;cursor:pointer" onclick="closeRecipeModal()">âœ•</button>
    </div>
    <div style="padding:20px" id="recipeModalBody"></div>
  </div>
</div>

<div class="bottom-nav">
  <button class="nav-item active" onclick="switchTab('home')">
    <div class="nav-icon">ğŸ </div>
    <div class="nav-label">Ana Sayfa</div>
  </button>
  <button class="nav-item" onclick="switchTab('scan')">
    <div class="nav-icon">ğŸ“¸</div>
    <div class="nav-label">Ekle</div>
  </button>
  <button class="nav-item" onclick="switchTab('recipes')">
    <div class="nav-icon">ğŸ‘¨â€ğŸ³</div>
    <div class="nav-label">Tarifler</div>
  </button>
  <button class="nav-item" onclick="switchTab('history')">
    <div class="nav-icon">ğŸ“Š</div>
    <div class="nav-label">GeÃ§miÅŸ</div>
  </button>
  <button class="nav-item" onclick="switchTab('settings')">
    <div class="nav-icon">âš™ï¸</div>
    <div class="nav-label">Ayarlar</div>
  </button>
</div>

<script>
const API='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';
let meal='breakfast',photo=null,data=[],water=[],goals={calories:2000,protein:150,carbs:200,fat:60,water:2.5},chart,prof={name:'KullanÄ±cÄ±',photo:null};
const recipes=[
{name:"Kinoa SalatasÄ±",emoji:"ğŸ¥—",cal:320,protein:12,carbs:45,fat:10,ing:["Kinoa","Domates","SalatalÄ±k"],ins:"KinoayÄ± haÅŸlayÄ±n, sebzeleri ekleyin."},
{name:"Izgara Tavuk",emoji:"ğŸ—",cal:165,protein:31,carbs:0,fat:3.6,ing:["Tavuk","Baharat"],ins:"Marine edip Ä±zgarada piÅŸirin."},
{name:"Yulaf LapasÄ±",emoji:"ğŸ¥£",cal:150,protein:5,carbs:27,fat:3,ing:["Yulaf","SÃ¼t","Meyve"],ins:"PiÅŸirin, meyve ekleyin."},
{name:"Avokado Toast",emoji:"ğŸ¥‘",cal:280,protein:8,carbs:30,fat:15,ing:["Ekmek","Avokado"],ins:"KÄ±zartÄ±n, avokado sÃ¼rÃ¼n."},
{name:"Somon Fileto",emoji:"ğŸŸ",cal:367,protein:39,carbs:0,fat:22,ing:["Somon","Limon"],ins:"FÄ±rÄ±nda piÅŸirin."}
];
for(let i=0;i<95;i++)recipes.push({name:`Tarif ${i+6}`,emoji:["ğŸ¥—","ğŸ²","ğŸ³"][i%3],cal:200+Math.random()*300|0,protein:10+Math.random()*25|0,carbs:20+Math.random()*50|0,fat:5+Math.random()*20|0,ing:["Malzeme 1","Malzeme 2"],ins:"PiÅŸirin."});

document.addEventListener('DOMContentLoaded',()=>{
  loadData();updateDate();initUpload();initWater();initProfile();updateUI();initChart();loadRecipes();
});

function loadData(){
  try{
    const s=localStorage.getItem('calorieData');
    if(s)data=JSON.parse(s);
    const w=localStorage.getItem('waterData');
    if(w)water=JSON.parse(w);
    const g=localStorage.getItem('macroGoals');
    if(g){
      goals=JSON.parse(g);
      document.getElementById('goalCalories').value=goals.calories;
      document.getElementById('goalProtein').value=goals.protein;
      document.getElementById('goalCarbs').value=goals.carbs;
      document.getElementById('goalFat').value=goals.fat;
      document.getElementById('goalWater').value=goals.water;
    }
    const p=localStorage.getItem('userProfile');
    if(p){
      prof=JSON.parse(p);
      document.getElementById('profileName').value=prof.name;
      document.getElementById('userName').textContent=prof.name+'! ğŸ‘‹';
      if(prof.photo){
        document.getElementById('headerProfilePic').src=prof.photo;
        document.getElementById('profilePicLarge').src=prof.photo;
      }
    }
  }catch(e){console.error(e)}
}

function updateDate(){
  const d=new Date().toLocaleDateString('tr-TR',{weekday:'long',day:'numeric',month:'long'});
  document.getElementById('todayDate').textContent=d;
}

function initWater(){
  const c=document.getElementById('waterGlasses');
  for(let i=0;i<10;i++){
    const g=document.createElement('div');
    g.className='water-glass';
    g.innerHTML='ğŸ’§';
    g.onclick=()=>toggleWater(i);
    c.appendChild(g);
  }
  updateWater();
}

function toggleWater(i){
  const t=new Date().toDateString();
  const w=water.filter(x=>new Date(x.date).toDateString()===t);
  if(w.length>i)water=water.filter(x=>!(new Date(x.date).toDateString()===t&&water.indexOf(x)===water.findIndex(y=>new Date(y.date).toDateString()===t)+i));
  else water.push({date:new Date().toISOString(),amount:0.25});
  localStorage.setItem('waterData',JSON.stringify(water));
  updateWater();
}

function updateWater(){
  const t=new Date().toDateString();
  const w=water.filter(x=>new Date(x.date).toDateString()===t);
  document.getElementById('waterAmount').textContent=(w.length*0.25).toFixed(1);
  document.querySelectorAll('.water-glass').forEach((g,i)=>g.classList.toggle('filled',i<w.length));
}

function initProfile(){
  document.getElementById('profilePicInput').addEventListener('change',e=>{
    const f=e.target.files[0];
    if(f){
      const r=new FileReader();
      r.onload=e=>{
        prof.photo=e.target.result;
        document.getElementById('headerProfilePic').src=e.target.result;
        document.getElementById('profilePicLarge').src=e.target.result;
      };
      r.readAsDataURL(f);
    }
  });
}

function saveProfile(){
  prof.name=document.getElementById('profileName').value;
  localStorage.setItem('userProfile',JSON.stringify(prof));
  document.getElementById('userName').textContent=prof.name+'! ğŸ‘‹';
  alert('âœ… Profil kaydedildi!');
}

function initUpload(){
  const h=e=>{
    const f=e.target.files[0];
    if(f){
      const r=new FileReader();
      r.onload=e=>{
        photo=e.target.result;
        document.getElementById('previewImage').src=photo;
        document.getElementById('previewSection').classList.add('show');
        document.getElementById('barcodeScanner').style.display='none';
      };
      r.readAsDataURL(f);
    }
  };
  document.getElementById('photoInput').addEventListener('change',h);
  document.getElementById('galleryInput').addEventListener('change',h);
  document.getElementById('analyzeBtn').addEventListener('click',analyze);
  document.querySelectorAll('.meal-option').forEach(b=>b.addEventListener('click',function(){
    document.querySelectorAll('.meal-option').forEach(x=>x.classList.remove('selected'));
    this.classList.add('selected');
    meal=this.dataset.meal;
  }));
}

function startBarcodeScanner(){
  switchTab('scan');
  const s=document.getElementById('barcodeScanner');
  s.style.display='block';
  document.getElementById('previewSection').classList.remove('show');
  if(typeof Quagga!=='undefined'){
    Quagga.init({
      inputStream:{name:"Live",type:"LiveStream",target:document.querySelector('#scanner-video')},
      decoder:{readers:["ean_reader","code_128_reader"]}
    },err=>{
      if(err){alert('Kamera hatasÄ±');return;}
      Quagga.start();
    });
    Quagga.onDetected(d=>{
      const b=d.codeResult.code;
      stopBarcodeScanner();
      const db={'8690632006857':{name:'Ãœlker Ã‡ikolata',calories:220,protein:3,carbs:25,fat:12,score:4}};
      const p=db[b];
      if(p)showResult(p);
      else alert('âš ï¸ Barkod bulunamadÄ±');
    });
  }else alert('TarayÄ±cÄ± yÃ¼klenemedi');
}

function stopBarcodeScanner(){
  if(typeof Quagga!=='undefined')Quagga.stop();
  document.getElementById('barcodeScanner').style.display='none';
}

async function analyze(){
  if(!photo)return;
  const l=document.getElementById('loadingState');
  const r=document.getElementById('resultSection');
  const b=document.getElementById('analyzeBtn');
  l.classList.add('show');
  r.classList.remove('show');
  b.disabled=true;
  try{
    const img=photo.split(',')[1];
    if(!img)throw new Error('GeÃ§ersiz fotoÄŸraf');
    const res=await fetch('https://api.anthropic.com/v1/messages',{
      method:'POST',
      headers:{'Content-Type':'application/json','x-api-key':API,'anthropic-version':'2023-06-01'},
      body:JSON.stringify({
        model:'claude-3-5-sonnet-20241022',
        max_tokens:1024,
        messages:[{
          role:'user',
          content:[
            {type:'image',source:{type:'base64',media_type:'image/jpeg',data:img}},
            {type:'text',text:'Bu yemek fotoÄŸrafÄ±nÄ± analiz et ve JSON ver:\n{"foodName":"ad","calories":sayÄ±,"protein":sayÄ±,"carbs":sayÄ±,"fat":sayÄ±,"score":1-10,"comment":"kÄ±sa TÃ¼rkÃ§e yorum"}\nSadece JSON ver.'}
          ]
        }]
      })
    });
    if(!res.ok)throw new Error(`API HatasÄ±: ${res.status}`);
    const d=await res.json();
    const txt=d.content[0].text;
    const m=txt.match(/\{[\s\S]*\}/);
    if(!m)throw new Error('JSON bulunamadÄ±');
    showResult(JSON.parse(m[0]));
  }catch(e){
    alert('âŒ Analiz hatasÄ±: '+e.message+'\n\nÄ°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.');
    l.classList.remove('show');
  }finally{
    b.disabled=false;
  }
}

function showResult(r){
  document.getElementById('loadingState').classList.remove('show');
  document.getElementById('resultFoodName').textContent=r.foodName||r.name;
  document.getElementById('resultScore').textContent=r.score;
  document.getElementById('resultCalories').textContent=r.calories;
  document.getElementById('resultProtein').textContent=r.protein;
  document.getElementById('resultCarbs').textContent=r.carbs;
  document.getElementById('resultFat').textContent=r.fat;
  document.getElementById('resultComment').textContent=r.comment||'GÃ¼zel seÃ§im!';
  const t=(r.protein*4)+(r.carbs*4)+(r.fat*9);
  const pr=((r.protein*4)/t*100|0);
  const cr=((r.carbs*4)/t*100|0);
  const fr=((r.fat*9)/t*100|0);
  document.getElementById('ratioProtein').style.width=pr+'%';
  document.getElementById('ratioCarbs').style.width=cr+'%';
  document.getElementById('ratioFat').style.width=fr+'%';
  document.getElementById('ratioProteinText').textContent=pr+'%';
  document.getElementById('ratioCarbsText').textContent=cr+'%';
  document.getElementById('ratioFatText').textContent=fr+'%';
  window.cur={...r,foodName:r.foodName||r.name,image:photo};
  document.getElementById('resultSection').classList.add('show');
}

document.getElementById('saveBtn').addEventListener('click',()=>{
  if(!window.cur)return;
  data.push({id:Date.now(),date:new Date().toISOString(),meal,...window.cur});
  localStorage.setItem('calorieData',JSON.stringify(data));
  document.getElementById('resultSection').classList.remove('show');
  document.getElementById('previewSection').classList.remove('show');
  document.getElementById('photoInput').value='';
  document.getElementById('galleryInput').value='';
  photo=null;
  window.cur=null;
  updateUI();
  switchTab('home');
  const m=document.createElement('div');
  m.style.cssText='position:fixed;top:20px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#10B981,#059669);color:white;padding:16px 24px;border-radius:12px;font-weight:600;z-index:9999';
  m.textContent='âœ… BaÅŸarÄ±yla kaydedildi!';
  document.body.appendChild(m);
  setTimeout(()=>m.remove(),3000);
});

function updateUI(){
  updateMacros();updateToday();updatePreview();updateChart();updateStats();updateWater();
}

function updateMacros(){
  const t=new Date().toDateString();
  const d=data.filter(x=>new Date(x.date).toDateString()===t);
  const c=d.reduce((s,x)=>s+x.calories,0);
  const pr=d.reduce((s,x)=>s+x.protein,0);
  const ca=d.reduce((s,x)=>s+x.carbs,0);
  const f=d.reduce((s,x)=>s+x.fat,0);
  document.getElementById('totalCal').textContent=c;
  document.getElementById('totalProtein').textContent=pr|0;
  document.getElementById('totalCarbs').textContent=ca|0;
  document.getElementById('totalFat').textContent=f|0;
  document.getElementById('remainingCal').textContent=Math.max(0,goals.calories-c);
  document.getElementById('goalCal').textContent=goals.calories;
  document.getElementById('waterGoal').textContent=goals.water;
  const p=Math.min(c/goals.calories*100,100);
  const cir=2*Math.PI*75;
  document.getElementById('calorieRing').style.strokeDashoffset=cir-(p/100)*cir;
  const prp=Math.min(pr/goals.protein*100,100);
  const cap=Math.min(ca/goals.carbs*100,100);
  const fp=Math.min(f/goals.fat*100,100);
  document.getElementById('proteinBar').style.width=prp+'%';
  document.getElementById('carbsBar').style.width=cap+'%';
  document.getElementById('fatBar').style.width=fp+'%';
  document.getElementById('proteinPercent').textContent=(prp|0)+'%';
  document.getElementById('carbsPercent').textContent=(cap|0)+'%';
  document.getElementById('fatPercent').textContent=(fp|0)+'%';
  document.getElementById('motivationPercent').textContent=(p|0);
}

function updateToday(){
  const t=new Date().toDateString();
  const d=data.filter(x=>new Date(x.date).toDateString()===t);
  const m={breakfast:{name:'KahvaltÄ±',icon:'ğŸŒ…',items:[]},lunch:{name:'Ã–ÄŸle',icon:'â˜€ï¸',items:[]},dinner:{name:'AkÅŸam',icon:'ğŸŒ™',items:[]},snack:{name:'AtÄ±ÅŸtÄ±rma',icon:'ğŸª',items:[]}};
  d.forEach(x=>m[x.meal]&&m[x.meal].items.push(x));
  let h='';
  Object.entries(m).forEach(([k,v])=>{
    if(v.items.length>0){
      const tot=v.items.reduce((s,x)=>s+x.calories,0);
      h+=`<div style="margin-bottom:25px"><div style="display:flex;justify-content:space-between;margin-bottom:12px"><div style="font-size:18px;font-weight:700">${v.icon} ${v.name}</div><div style="font-size:16px;font-weight:700;color:#8B5CF6">${tot} kcal</div></div>`;
      v.items.forEach(x=>{
        h+=`<div class="food-card"><div class="food-image-wrapper">${x.image?`<img src="${x.image}" class="food-image">`:'<div class="food-placeholder">ğŸ½ï¸</div>'}</div><div class="food-details"><div class="food-name">${x.foodName}</div><div class="food-macros"><span>ğŸ¥© ${x.protein}g</span><span>ğŸ ${x.carbs}g</span><span>ğŸ¥‘ ${x.fat}g</span></div><div class="food-score">â­ ${x.score}/10</div></div><div style="display:flex;flex-direction:column;align-items:flex-end;justify-content:space-between"><div class="food-calories">${x.calories}</div><button class="delete-btn" onclick="deleteEntry(${x.id})">ğŸ—‘ï¸</button></div></div>`;
      });
      h+='</div>';
    }
  });
  document.getElementById('todayMeals').innerHTML=h||'<div class="empty-state"><div class="empty-icon">ğŸ½ï¸</div><div style="font-size:20px;font-weight:700;margin-bottom:8px">HenÃ¼z yemek yok</div></div>';
}

function updatePreview(){
  const t=new Date().toDateString();
  const d=data.filter(x=>new Date(x.date).toDateString()===t).slice(0,2);
  let h='';
  d.forEach(x=>{
    h+=`<div class="food-card"><div class="food-image-wrapper">${x.image?`<img src="${x.image}" class="food-image">`:'<div class="food-placeholder">ğŸ½ï¸</div>'}</div><div class="food-details"><div class="food-name">${x.foodName}</div><div class="food-macros"><span>ğŸ¥© ${x.protein}g</span><span>ğŸ ${x.carbs}g</span><span>ğŸ¥‘ ${x.fat}g</span></div></div><div style="display:flex;flex-direction:column;align-items:flex-end;justify-content:space-between"><div class="food-calories">${x.calories}</div></div></div>`;
  });
  document.getElementById('todayPreview').innerHTML=h||'<div class="empty-state"><div class="empty-icon">ğŸ½ï¸</div><div style="font-size:20px;font-weight:700">HenÃ¼z yemek yok</div></div>';
}

function initChart(){
  chart=new Chart(document.getElementById('weekChart'),{
    type:'line',
    data:{labels:[],datasets:[{label:'Kalori',data:[],borderColor:'#8B5CF6',backgroundColor:'rgba(139,92,246,0.1)',tension:0.4,fill:true}]},
    options:{responsive:true,maintainAspectRatio:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,grid:{color:'#F3F4F6'}},x:{grid:{display:false}}}}
  });
}

function updateChart(){
  if(!chart)return;
  const d=[];
  for(let i=6;i>=0;i--){
    const dt=new Date();
    dt.setDate(dt.getDate()-i);
    d.push(dt.toDateString());
  }
  const l=d.map(x=>new Date(x).toLocaleDateString('tr-TR',{weekday:'short'}));
  const v=d.map(x=>data.filter(y=>new Date(y.date).toDateString()===x).reduce((s,y)=>s+y.calories,0));
  chart.data.labels=l;
  chart.data.datasets[0].data=v;
  chart.update();
}

function updateStats(){
  document.getElementById('totalEntries').textContent=data.length;
  const t=data.reduce((s,x)=>s+x.calories,0);
  document.getElementById('avgCalories').textContent=data.length>0?(t/data.length|0):0;
}

function loadRecipes(){
  document.getElementById('recipeGrid').innerHTML=recipes.map((r,i)=>`<div class="recipe-card" onclick="showRecipe(${i})"><div class="recipe-image">${r.emoji}</div><div class="recipe-info"><div style="font-size:14px;font-weight:700;margin-bottom:6px">${r.name}</div><div style="font-size:11px;color:#6B7280"><span>ğŸ”¥ ${r.cal} kcal</span></div></div></div>`).join('');
}

function showRecipe(i){
  const r=recipes[i];
  document.getElementById('recipeModalTitle').textContent=r.name;
  document.getElementById('recipeModalBody').innerHTML=`<div style="text-align:center;font-size:72px;margin-bottom:20px">${r.emoji}</div><h4 style="margin-bottom:10px">ğŸ“Š Besin DeÄŸerleri</h4><div style="background:var(--bg);padding:15px;border-radius:12px;margin-bottom:20px"><div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px"><div>ğŸ”¥ ${r.cal} kcal</div><div>ğŸ¥© ${r.protein}g</div><div>ğŸ ${r.carbs}g</div><div>ğŸ¥‘ ${r.fat}g</div></div></div><h4 style="margin-bottom:10px">ğŸ›’ Malzemeler</h4><ul style="margin-bottom:20px">${r.ing.map(x=>`<li>${x}</li>`).join('')}</ul><h4 style="margin-bottom:10px">ğŸ‘¨â€ğŸ³ HazÄ±rlanÄ±ÅŸ</h4><p>${r.ins}</p>`;
  document.getElementById('recipeModal').classList.add('show');
}

function closeRecipeModal(){
  document.getElementById('recipeModal').classList.remove('show');
}

function deleteEntry(id){
  if(confirm('Silmek istediÄŸine emin misin?')){
    data=data.filter(x=>x.id!==id);
    localStorage.setItem('calorieData',JSON.stringify(data));
    updateUI();
  }
}

function clearAllData(){
  if(confirm('âš ï¸ TÃœM VERÄ°LERÄ° SÄ°LMEK EMÄ°N MÄ°SÄ°N?\n\nGeri alÄ±namaz!')){
    localStorage.clear();
    data=[];
    water=[];
    updateUI();
    alert('âœ… Silindi!');
  }
}

function saveGoals(){
  goals={
    calories:+document.getElementById('goalCalories').value,
    protein:+document.getElementById('goalProtein').value,
    carbs:+document.getElementById('goalCarbs').value,
    fat:+document.getElementById('goalFat').value,
    water:+document.getElementById('goalWater').value
  };
  localStorage.setItem('macroGoals',JSON.stringify(goals));
  updateUI();
  alert('âœ… Hedefler kaydedildi!');
}

function switchTab(t){
  document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(x=>x.classList.remove('active'));
  document.getElementById(t+'Tab').classList.add('active');
  const m={home:0,scan:1,recipes:2,history:3,settings:4};
  if(m[t]!==undefined)document.querySelectorAll('.nav-item')[m[t]].classList.add('active');
  if(t==='history')updateChart();
  if(t==='home')updatePreview();
  if(t==='recipes')loadRecipes();
}

console.log('âœ… Kalori Pro Premium hazÄ±r!');
</script>
</body>
</html>
